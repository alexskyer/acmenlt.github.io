<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å‰è¨€ | é¾™å°æŠ€æœ¯ç¬”è®°</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/images/book.png">
    <link rel="manifest" href="/images/book.png">
    <link rel="apple-touch-icon" href="/images/book.png">
    <meta name="description" content="æŠ€æœ¯äººå†™çš„æŠ€æœ¯ç¬”è®°ï¼ˆå·¥ä½œæ€»ç»“ï¼‰">
    <meta http-quiv="pragma" cotent="no-cache">
    <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
    <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/assets/css/0.styles.84741abc.css" as="style"><link rel="preload" href="/assets/js/app.1b4c17a3.js" as="script"><link rel="preload" href="/assets/js/2.ad010850.js" as="script"><link rel="preload" href="/assets/js/32.12e9a817.js" as="script"><link rel="prefetch" href="/assets/js/10.94d80ba6.js"><link rel="prefetch" href="/assets/js/11.2f420b54.js"><link rel="prefetch" href="/assets/js/12.780d4496.js"><link rel="prefetch" href="/assets/js/13.a5ec8293.js"><link rel="prefetch" href="/assets/js/14.22c75bd2.js"><link rel="prefetch" href="/assets/js/15.a6bc3bc3.js"><link rel="prefetch" href="/assets/js/16.40ca1c91.js"><link rel="prefetch" href="/assets/js/17.1ecdc880.js"><link rel="prefetch" href="/assets/js/18.f657f93c.js"><link rel="prefetch" href="/assets/js/19.76f9fefa.js"><link rel="prefetch" href="/assets/js/20.d7e54280.js"><link rel="prefetch" href="/assets/js/21.87a15fe3.js"><link rel="prefetch" href="/assets/js/22.35a749d4.js"><link rel="prefetch" href="/assets/js/23.dee18ee7.js"><link rel="prefetch" href="/assets/js/24.3179102b.js"><link rel="prefetch" href="/assets/js/25.f4debb1b.js"><link rel="prefetch" href="/assets/js/26.53e571d4.js"><link rel="prefetch" href="/assets/js/27.2649242b.js"><link rel="prefetch" href="/assets/js/28.bd7b7239.js"><link rel="prefetch" href="/assets/js/29.178488c4.js"><link rel="prefetch" href="/assets/js/3.f5671358.js"><link rel="prefetch" href="/assets/js/30.dba7fb10.js"><link rel="prefetch" href="/assets/js/31.321ab434.js"><link rel="prefetch" href="/assets/js/33.1efba5ba.js"><link rel="prefetch" href="/assets/js/34.e5d5831c.js"><link rel="prefetch" href="/assets/js/35.1ae0fc93.js"><link rel="prefetch" href="/assets/js/36.4d65b835.js"><link rel="prefetch" href="/assets/js/37.6a50545e.js"><link rel="prefetch" href="/assets/js/38.d78bb435.js"><link rel="prefetch" href="/assets/js/39.706e6b6c.js"><link rel="prefetch" href="/assets/js/4.52188786.js"><link rel="prefetch" href="/assets/js/40.f2fd40f1.js"><link rel="prefetch" href="/assets/js/41.b5d516b6.js"><link rel="prefetch" href="/assets/js/42.b865b616.js"><link rel="prefetch" href="/assets/js/43.f9d76365.js"><link rel="prefetch" href="/assets/js/44.a77506c5.js"><link rel="prefetch" href="/assets/js/45.f6c0a8dd.js"><link rel="prefetch" href="/assets/js/46.0ad618af.js"><link rel="prefetch" href="/assets/js/47.0079f20d.js"><link rel="prefetch" href="/assets/js/48.64c7ca11.js"><link rel="prefetch" href="/assets/js/49.43a22984.js"><link rel="prefetch" href="/assets/js/5.59fc555e.js"><link rel="prefetch" href="/assets/js/6.256d2fbb.js"><link rel="prefetch" href="/assets/js/7.0d1e400d.js"><link rel="prefetch" href="/assets/js/8.aab2d760.js"><link rel="prefetch" href="/assets/js/9.902bae2f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.84741abc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">é¾™å°æŠ€æœ¯ç¬”è®°</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/home/guide.html" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/db/" class="nav-link">
  æ•°æ®åº“
</a></div><div class="nav-item"><a href="/thread/" class="nav-link">
  å¹¶å‘ç¼–ç¨‹
</a></div><div class="nav-item"><a href="/frame/" class="nav-link router-link-active">
  æ¡†æ¶çŸ¥è¯†
</a></div><div class="nav-item"><a href="/design/" class="nav-link">
  ä»£ç è®¾è®¡
</a></div><div class="nav-item"><a href="/bug/" class="nav-link">
  BUG ä¸“æ 
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…¶å®ƒ" class="dropdown-title"><span class="title">å…¶å®ƒ</span> <span class="arrow down"></span></button> <button type="button" aria-label="å…¶å®ƒ" class="mobile-dropdown-title"><span class="title">å…¶å®ƒ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/acmenlt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  åŠ¨æ€çº¿ç¨‹æ± 
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://house.machen.me" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ä¹°æˆ¿å®è·µ
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/acmenlt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/home/guide.html" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/db/" class="nav-link">
  æ•°æ®åº“
</a></div><div class="nav-item"><a href="/thread/" class="nav-link">
  å¹¶å‘ç¼–ç¨‹
</a></div><div class="nav-item"><a href="/frame/" class="nav-link router-link-active">
  æ¡†æ¶çŸ¥è¯†
</a></div><div class="nav-item"><a href="/design/" class="nav-link">
  ä»£ç è®¾è®¡
</a></div><div class="nav-item"><a href="/bug/" class="nav-link">
  BUG ä¸“æ 
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…¶å®ƒ" class="dropdown-title"><span class="title">å…¶å®ƒ</span> <span class="arrow down"></span></button> <button type="button" aria-label="å…¶å®ƒ" class="mobile-dropdown-title"><span class="title">å…¶å®ƒ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/acmenlt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  åŠ¨æ€çº¿ç¨‹æ± 
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://house.machen.me" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ä¹°æˆ¿å®è·µ
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/acmenlt" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>å‰è¨€</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frame/%E9%AA%9A%E6%93%8D%E4%BD%9C%EF%BC%8C%E8%AF%B4%E7%82%B9%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84Spring%E6%B3%A8%E5%86%8CIOC-Bean%E6%96%B9%E5%BC%8F.html#å‰è¨€" class="sidebar-link">å‰è¨€</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/frame/%E9%AA%9A%E6%93%8D%E4%BD%9C%EF%BC%8C%E8%AF%B4%E7%82%B9%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84Spring%E6%B3%A8%E5%86%8CIOC-Bean%E6%96%B9%E5%BC%8F.html#æ³¨å†Œ-ioc-å®¹å™¨-bean" class="sidebar-link">æ³¨å†Œ IOC å®¹å™¨ Bean</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/frame/%E9%AA%9A%E6%93%8D%E4%BD%9C%EF%BC%8C%E8%AF%B4%E7%82%B9%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84Spring%E6%B3%A8%E5%86%8CIOC-Bean%E6%96%B9%E5%BC%8F.html#ä»£ç å®æˆ˜" class="sidebar-link">ä»£ç å®æˆ˜</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/frame/%E9%AA%9A%E6%93%8D%E4%BD%9C%EF%BC%8C%E8%AF%B4%E7%82%B9%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84Spring%E6%B3%A8%E5%86%8CIOC-Bean%E6%96%B9%E5%BC%8F.html#ç»“è¨€" class="sidebar-link">ç»“è¨€</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="å‰è¨€"><a href="#å‰è¨€" class="header-anchor">#</a> å‰è¨€</h2> <p>Spring çš„å‡ºç°æ˜¯å¯¹å¹¿å¤§ Java Web å¼€å‘è€…çš„ç¦éŸ³ï¼Œå¸®åŠ©æˆ‘ä»¬è§£å†³äº†ä¼—å¤šé—®é¢˜å¹¶ä¸”æä¾›äº†å¾ˆå¤šä¾¿åˆ©</p> <p>å†™æ­¤æ–‡ç« ä¸»è¦æ¥è¯´æ˜å¯¹äº Spring IOC å®¹å™¨ä¸­æ³¨å†Œ Bean çš„æ–¹å¼ä¸»è¦æœ‰å“ªå‡ ç§</p> <p>å¦‚æœä½ ä»¥ä¸ºæˆ‘ä¼šå‘Šè¯‰ä½ </p> <ul><li>@Bean</li> <li>@Importã€@ImportSelector...</li> <li>@Serviceã€@Component...</li></ul> <p>å¾ˆé—æ†¾çš„è¯´ï¼š<strong>æ ¼å±€å°äº†å…„å¼Ÿ...</strong></p> <p>è™½ç„¶è¿™ç¯‡æ–‡ç« æ˜¯ä½œè€…çœ‹ Mybatis Spring é›†æˆæºç ä¹‹åï¼Œå†³å®šå…ˆæ°´ä¸€ç¯‡æ¢è·¯çš„æ–‡ç« </p> <p>ä½†æ˜¯ï¼<strong>æ°´ä¹Ÿå¾—æ°´å‡ºé«˜çº§æ„Ÿä¹ˆä¸æ˜¯</strong>ï¼Œæ€ä¹ˆä¸å¾—è®©å°ä¼™ä¼´æœ‰ç‚¹æ”¶è·ï¼Œçœ‹ç‚¹å·¥ä½œä¸­ä¸å¸¸ç”¨åˆ°çš„</p> <h2 id="æ³¨å†Œ-ioc-å®¹å™¨-bean"><a href="#æ³¨å†Œ-ioc-å®¹å™¨-bean" class="header-anchor">#</a> æ³¨å†Œ IOC å®¹å™¨ Bean</h2> <p>é™¤äº†ä¸Šæ–‡ä¸­è¯´åˆ°çš„æ³¨å†Œ Bean æ–¹å¼ï¼Œæ–‡ç« ä¸»è¦ä½¿ç”¨ BeanDefinitionRegistryPostProcessorï¼ˆä»¥ä¸‹ç®€ç§°ï¼šBDï¼‰ æ¥è¿›è¡Œ Bean æ³¨å†Œ</p> <p>åè¯å¯èƒ½æ²¡å¬è¯´è¿‡ï¼Œä½†æ˜¯å¦‚æœè¯´å®ƒæ˜¯BeanFactoryPostProcessor åç½®å¤„ç†å™¨ï¼ˆä»¥ä¸‹ç®€ç§°BFï¼‰å­ç±»ï¼Œåº”è¯¥å°±æ¸…æ¥šå¾ˆå¤šäº†</p> <p><img src="https://images-machen.oss-cn-beijing.aliyuncs.com/image-20201125221631186.png" alt=""></p> <p>æ•´ä½“çš„å…³ç³»æ¯”è¾ƒç®€æ´ï¼Œåªæ˜¯ç»§æ‰¿äº† Spring åç½®å¤„ç†å™¨ï¼Œå…ˆçœ‹ä¸‹æ¥å£å®šä¹‰æ˜¯æ€ä¹ˆä»‹ç»çš„</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * Extension to the standard {@link BeanFactoryPostProcessor} SPI, allowing for
 * the registration of further bean definitions &lt;i&gt;before&lt;/i&gt; regular
 * BeanFactoryPostProcessor detection kicks in. In particular,
 * BeanDefinitionRegistryPostProcessor may register further bean definitions
 * which in turn define BeanFactoryPostProcessor instances.
 *
 * @author Juergen Hoeller
 * @since 3.0.1
 * @see org.springframework.context.annotation.ConfigurationClassPostProcessor
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BeanDefinitionRegistryPostProcessor</span> <span class="token keyword">extends</span> <span class="token class-name">BeanFactoryPostProcessor</span> <span class="token punctuation">{</span>

	<span class="token comment">/**
	 * Modify the application context's internal bean definition registry after its
	 * standard initialization. All regular bean definitions will have been loaded,
	 * but no beans will have been instantiated yet. This allows for adding further
	 * bean definitions before the next post-processing phase kicks in.
	 * @param registry the bean definition registry used by the application context
	 * @throws org.springframework.beans.BeansException in case of errors
	 */</span>
	<span class="token keyword">void</span> <span class="token function">postProcessBeanDefinitionRegistry</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>æ¥å£ä¸Šé¢è¿™ä¸€æ®µè®©äººçœ‹ä¸æ‡‚çš„è‹±æ–‡è¯´çš„å•¥æ„æ€å‘¢ï¼Ÿ</p> <blockquote><p>å¤§è‡´è¯´çš„æ˜¯å½“å‰æ¥å£æ˜¯åç½®å¤„ç†å™¨çš„ SPI æ‰©å±•ï¼Œä¼šåœ¨åç½®å¤„ç†å™¨å·¥ä½œå‰å®šä¹‰æ›´å¤šçš„ Bean</p></blockquote> <p>å› ä¸º BDï¼ˆå¯æ³¨å†ŒBeanæ¥å£ï¼‰ ç»§æ‰¿äº† BFï¼ˆåç½®å¤„ç†å™¨ï¼‰ æ¥å£ï¼Œæ‰€ä»¥å¦‚æœå®ç° BP å°±éœ€è¦å®ç°ä¸¤ä¸ªæ–¹æ³•</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token operator">--</span> <span class="token class-name">BeanFactoryPostProcessor</span>
<span class="token keyword">void</span> <span class="token function">postProcessBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableListableBeanFactory</span> beanFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
<span class="token operator">--</span> <span class="token class-name">BeanDefinitionRegistryPostProcessor</span>
<span class="token keyword">void</span> <span class="token function">postProcessBeanDefinitionRegistry</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistry</span> registry<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>mybatis ä¸ spring æºç é›†æˆä¸Šä¹Ÿæ˜¯ä½¿ç”¨æ­¤æ–¹å¼ï¼Œå°† DAO å¯¹è±¡æ³¨å†Œ Spring IOC å®¹å™¨</strong></p> <p><strong>postProcessBeanFactory</strong></p> <p>è¯¥æ–¹æ³•ä¸»è¦å¯¹å·²æ³¨å†Œ Spring Bean çš„å®šä¹‰åšå‡ºæ”¹å˜</p> <p><strong>postProcessBeanDefinitionRegistry</strong></p> <p>è¯¥æ–¹æ³•ä¸»è¦æ˜¯å°† Bean å®šä¹‰æ³¨å†Œåˆ° Spring IOC å®¹å™¨ä¸­ï¼Œå…·ä½“çš„ Bean ç»†èŠ‚ä½“ç°å…¥å‚ BeanDefinitionRegistry</p> <p><strong>BeanDefinitionRegistry</strong></p> <p>BeanDefinitionRegistry æ˜¯ä¸€ä¸ªæ¥å£å¹¶å®ç°äº† AliasRegistry æ¥å£ï¼Œå…¶ä¸­æ–¹æ³•å®šä¹‰äº†å¯¹ Bean çš„å¸¸ç”¨æ“ä½œ</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// å‘IOCå®¹å™¨ä¸­æ³¨å†ŒBeanDefinitionå®ä¾‹</span>
<span class="token keyword">void</span> <span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">BeanDefinition</span> beanDefinition<span class="token punctuation">)</span>
			<span class="token keyword">throws</span> <span class="token class-name">BeanDefinitionStoreException</span><span class="token punctuation">;</span>
<span class="token comment">// ç§»é™¤å·²å­˜åœ¨çš„BeanDefinitionå®ä¾‹</span>
<span class="token keyword">void</span> <span class="token function">removeBeanDefinition</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchBeanDefinitionException</span><span class="token punctuation">;</span>
<span class="token comment">// è·å–BeanDefinitionå®ä¾‹</span>
<span class="token class-name">BeanDefinition</span> <span class="token function">getBeanDefinition</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchBeanDefinitionException</span><span class="token punctuation">;</span>
<span class="token comment">// åˆ¤æ–­beanNameæ˜¯å¦åœ¨IOCå®¹å™¨ä¸­</span>
<span class="token keyword">boolean</span> <span class="token function">containsBeanDefinition</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// è·å–IOCå®¹å™¨ä¸­æ‰€æœ‰å®ä¾‹åç§°</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getBeanDefinitionNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// è·å–IOCå®¹å™¨ä¸­å®ä¾‹æ•°é‡</span>
<span class="token keyword">int</span> <span class="token function">getBeanDefinitionCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// åˆ¤æ–­beanNameæ˜¯å¦è¢«å ç”¨</span>
<span class="token keyword">boolean</span> <span class="token function">isBeanNameInUse</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>postProcessBeanDefinitionRegistry æ–¹æ³•ç›´æ¥é€šè¿‡å…¥å‚å°±å¯ä»¥å®Œæˆ Bean çš„æ³¨å†Œã€ç§»é™¤ã€åˆ¤æ–­ç­‰ç­‰æ“ä½œ</p> <p>AliasRegistry æ¥å£ä¸­å®šä¹‰çš„æ˜¯ IOC å®¹å™¨ Bean åˆ«åç®¡ç†ï¼Œå°±ä¸å†ä¸€ä¸€ä»‹ç»äº†</p> <h2 id="ä»£ç å®æˆ˜"><a href="#ä»£ç å®æˆ˜" class="header-anchor">#</a> ä»£ç å®æˆ˜</h2> <p>åˆ›å»ºä¸€ä¸ª SpringBoot çš„é¡¹ç›®æˆ–è€…åœ¨å·²æœ‰é¡¹ç›®æµ‹è¯•éƒ½å¯ä»¥</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanRegistryTest</span> <span class="token keyword">implements</span> <span class="token class-name">BeanDefinitionRegistryPostProcessor</span><span class="token punctuation">,</span> <span class="token class-name">ApplicationContextAware</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postProcessBeanDefinitionRegistry</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinitionRegistry</span> beanDefinitionRegistry<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token class-name">GenericBeanDefinition</span> parentBeanDef <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GenericBeanDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        parentBeanDef<span class="token punctuation">.</span><span class="token function">setBeanClass</span><span class="token punctuation">(</span><span class="token class-name">BeanRegistry</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        beanDefinitionRegistry<span class="token punctuation">.</span><span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;beanRegistry&quot;</span><span class="token punctuation">,</span> rootBeanDefinition<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postProcessBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableListableBeanFactory</span> configurableListableBeanFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æ³¨å†ŒBeanå¯¹è±¡ :: &quot;</span> <span class="token operator">+</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;beanRegistry&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>applicationContext <span class="token operator">=</span> applicationContext<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">BeanRegistry</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>GenericBeanDefinition æ˜¯ BeanDefinition æ¥å£é€šç”¨å®ç°ï¼Œè´Ÿè´£è®°å½• Bean å¯¹è±¡ä¿¡æ¯</p> <p>ä»£ç æ¯”è¾ƒç®€å•æ˜äº†ï¼Œä¸ºäº†æ–¹ä¾¿åœ¨ä¸€ä¸ªç±»ä¸­å®ç°ï¼Œé€šè¿‡ä»¥ä¸‹æ­¥éª¤å®Œæˆ Bean æ³¨å†Œæµ‹è¯•</p> <ol><li>é€šè¿‡å®ç° ApplicationContextAware æ¥å£èµ‹å€¼ ApplicationContext å¯¹è±¡</li> <li>BeanDefinitionRegistryPostProcessor æ¥å£å®Œæˆå¯¹è±¡æ³¨å†Œä»¥åŠæ‰“å°å¯¹åº”æ³¨å†Œä¿¡æ¯</li> <li>postProcessBeanDefinitionRegistry æ–¹æ³•ä¸­æ³¨å†Œ BeanRegistry åˆ° Spring IOC å®¹å™¨ä¸­</li> <li>postProcessBeanFactory æ‰“å° Spring IOC å®¹å™¨ä¸­çš„ BeanRegistry å¯¹è±¡ä¿¡æ¯</li></ol> <h2 id="ç»“è¨€"><a href="#ç»“è¨€" class="header-anchor">#</a> ç»“è¨€</h2> <p>ç”±äºä½œè€…æ°´å¹³æœ‰é™, æ¬¢è¿å¤§å®¶èƒ½å¤Ÿåé¦ˆæŒ‡æ­£æ–‡ç« ä¸­é”™è¯¯ä¸æ­£ç¡®çš„åœ°æ–¹, æ„Ÿè°¢ ğŸ™</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1b4c17a3.js" defer></script><script src="/assets/js/2.ad010850.js" defer></script><script src="/assets/js/32.12e9a817.js" defer></script>
  </body>
</html>
