(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{400:function(a,t,s){"use strict";s.r(t);var e=s(45),r=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"å‰è¨€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[a._v("#")]),a._v(" å‰è¨€")]),a._v(" "),s("p",[a._v("æœ¬æ¬¡åˆ†äº«å†…å®¹ä¾æ® Mybatis-3-3.4.x æºç ")]),a._v(" "),s("h2",{attrs:{id:"_1ã€å¸¦ç€é—®é¢˜æ€è€ƒæœ¬æ¬¡åˆ†äº«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1ã€å¸¦ç€é—®é¢˜æ€è€ƒæœ¬æ¬¡åˆ†äº«"}},[a._v("#")]),a._v(" 1ã€å¸¦ç€é—®é¢˜æ€è€ƒæœ¬æ¬¡åˆ†äº«")]),a._v(" "),s("ol",[s("li",[a._v("Mybatis ä¸ JDBC çš„å…³ç³»")]),a._v(" "),s("li",[a._v(".xml æ–‡ä»¶å®šä¹‰ SQL è¯­å¥å¦‚ä½•è§£æ")]),a._v(" "),s("li",[a._v("Mybatis ä¸­ Mapper æ¥å£çš„å­˜å‚¨ä¸å®ç°")]),a._v(" "),s("li",[a._v("Mybatis SQL çš„æ‰§è¡Œè¿‡ç¨‹")]),a._v(" "),s("li",[a._v("Mybatis ä¸­åˆ†é¡µå¦‚ä½•å®ç°")])]),a._v(" "),s("h2",{attrs:{id:"_2ã€æŒä¹…å±‚çš„é‚£äº›äº‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2ã€æŒä¹…å±‚çš„é‚£äº›äº‹"}},[a._v("#")]),a._v(" 2ã€æŒä¹…å±‚çš„é‚£äº›äº‹")]),a._v(" "),s("h3",{attrs:{id:"_2-1-jdbc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-jdbc"}},[a._v("#")]),a._v(" 2.1 JDBC")]),a._v(" "),s("h4",{attrs:{id:"ä»€ä¹ˆæ˜¯-jdbc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯-jdbc"}},[a._v("#")]),a._v(" ä»€ä¹ˆæ˜¯ JDBC")]),a._v(" "),s("p",[a._v("JDBCï¼ˆJavaDataBase Connectivityï¼‰å°±æ˜¯ Java æ•°æ®åº“è¿æ¥, è¯´çš„ç›´ç™½ç‚¹å°±æ˜¯ "),s("strong",[a._v("ä½¿ç”¨ Java è¯­è¨€æ“ä½œæ•°æ®åº“")])]),a._v(" "),s("p",[a._v("æœ¬æ¥æˆ‘ä»¬æ˜¯é€šè¿‡æ§åˆ¶å°æˆ–å®¢æˆ·ç«¯æ“ä½œçš„æ•°æ®åº“, JDBC æ˜¯ç”¨ Java è¯­è¨€æ¥å‘é€ SQL è¯­å¥")]),a._v(" "),s("h4",{attrs:{id:"jdbc-åŸç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jdbc-åŸç†"}},[a._v("#")]),a._v(" JDBC åŸç†")]),a._v(" "),s("p",[a._v("æœ€åˆ SUN å…¬å¸å¸Œæœ›æä¾›ä¸€å¥— "),s("strong",[a._v("èƒ½å¤Ÿé€‚ç”¨æ‰€æœ‰æ•°æ®åº“çš„ API")]),a._v(", ä½†æ˜¯åœ¨å®é™…æ“ä½œä¸­å´å‘ç°è¿™æ˜¯é¡¹åŸºæœ¬ä¸å¯èƒ½å®Œæˆçš„ä»»åŠ¡")]),a._v(" "),s("p",[a._v("å› ä¸ºå„ä¸ªå‚å•†æ‰€æä¾›çš„ "),s("strong",[a._v("æ•°æ®åº“å·®å¼‚å®åœ¨å¤ªå¤§")]),a._v(", æ‰€ä»¥ SUN å…¬å¸ä¸æ•°æ®åº“å‚å•†è®¨è®ºå‡ºçš„å°±æ˜¯ï¼šç”± "),s("strong",[a._v("SUN å…¬å¸æä¾›å‡ºä¸€å¥—è®¿é—®æ•°æ®åº“çš„è§„èŒƒ API")]),a._v(", å¹¶æä¾›ç›¸å¯¹åº”çš„è¿æ¥æ•°æ®åº“åè®®æ ‡å‡†, ç„¶åå„å‚å•†æ ¹æ®è§„èŒƒæä¾›ä¸€å¥—è®¿é—®è‡ªå®¶æ•°æ®åº“çš„ API æ¥å£")]),a._v(" "),s("p",[a._v("æœ€ç»ˆï¼šSUN å…¬å¸æä¾›çš„è§„èŒƒ API ç§°ä¹‹ä¸º "),s("strong",[a._v("JDBC")]),a._v(", å„å‚å•†æä¾›çš„è‡ªå®¶æ•°æ®åº“ API æ¥å£ç§°ä¹‹ä¸º "),s("strong",[a._v("é©±åŠ¨")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/image-20200818124614542.png",alt:"JDBC æ¶æ„å›¾"}})]),a._v(" "),s("h3",{attrs:{id:"_2-2-mybatis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-mybatis"}},[a._v("#")]),a._v(" 2.2 Mybatis")]),a._v(" "),s("h4",{attrs:{id:"ä»€ä¹ˆæ˜¯-mybatis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯-mybatis"}},[a._v("#")]),a._v(" ä»€ä¹ˆæ˜¯ Mybatis")]),a._v(" "),s("p",[a._v("Mybatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„ ORMï¼ˆæŒä¹…å±‚ï¼‰æ¡†æ¶ï¼Œä½¿ç”¨ Java è¯­è¨€ ç¼–å†™")]),a._v(" "),s("p",[a._v("å‰èº«æ˜¯ apache çš„ä¸€ä¸ªå¼€æºé¡¹ç›® iBatisï¼Œ2010 å¹´è¿ç§»åˆ° google code å¹¶æ­£å¼æ”¹åä¸º Mybatis")]),a._v(" "),s("p",[a._v("ORM æŒä¹…å±‚ æŒ‡çš„æ˜¯ : "),s("strong",[a._v("å°†ä¸šåŠ¡æ•°æ®å­˜å‚¨åˆ°ç£ç›˜ï¼Œä¹Ÿå…·å¤‡é•¿æœŸå­˜å‚¨èƒ½åŠ›ï¼Œåªè¦ç£ç›˜ä¸æŸåï¼Œå¦‚æœåœ¨æ–­ç”µæƒ…å†µä¸‹ï¼Œé‡å¯ç³»ç»Ÿä»ç„¶å¯ä»¥è¯»å–æ•°æ®")])]),a._v(" "),s("h4",{attrs:{id:"mybatis-ä¸-jdbc-çš„å…³ç³»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mybatis-ä¸-jdbc-çš„å…³ç³»"}},[a._v("#")]),a._v(" Mybatis ä¸ JDBC çš„å…³ç³»")]),a._v(" "),s("p",[a._v("åœ¨æ²¡æœ‰æŒä¹…å±‚æ¡†æ¶ä¹‹å‰, æƒ³è¦ä»£ç ä¸­æ“ä½œæ•°æ®åº“éƒ½å¿…é¡»é€šè¿‡ JDBC æ¥æ“ä½œ, æ¥ä¸‹æ¥ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ä¸¤è€…ä¹‹é—´çš„å…³ç³»")]),a._v(" "),s("p",[s("strong",[a._v("JDBC æ“ä½œæ•°æ®åº“")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/carbon_jdbc.png",alt:"JDBC"}})]),a._v(" "),s("p",[a._v("ç›¸ä¿¡å¤§å®¶éƒ½åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨è¿‡ Mybatis, å¯ä»¥è”æƒ³ä¸€ä¸‹, å¹³å¸¸æˆ‘ä»¬å·¥ä½œä¸­, æ˜¯å¦åšè¿‡ä»¥ä¸‹äº‹æƒ…ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("æ˜¯å¦è£…è½½è¿‡æ•°æ®åº“é©±åŠ¨ï¼Ÿ")]),a._v(" "),s("li",[a._v("æ˜¯å¦ä»é©±åŠ¨ä¸­è·å–æ•°æ®åº“è¿æ¥ï¼Ÿ")]),a._v(" "),s("li",[a._v("æ˜¯å¦åˆ›å»ºè¿‡æ‰§è¡Œ SQL çš„ Statementï¼Ÿ")]),a._v(" "),s("li",[a._v("æ˜¯å¦è‡ªè¡Œå°†æ•°æ®åº“è¿”å›ç»“æœè½¬æ¢æˆ Java å¯¹è±¡ï¼Ÿ")]),a._v(" "),s("li",[a._v("æ˜¯å¦å…³é—­è¿‡ finally å—ä¸­çš„ä¸‰ä¸ªå¯¹è±¡ï¼Ÿ")])]),a._v(" "),s("p",[a._v("çœ‹åˆ°ä¸Šé¢çš„çµé­‚æ‹·é—®, å°±å¯ä»¥å¯¹æœ¬æ¬¡åˆ†äº«çš„ç¬¬ä¸€ä¸ªé—®é¢˜ä½œå‡ºè§£ç­”:")]),a._v(" "),s("p",[s("strong",[a._v("Mybatis é’ˆå¯¹ JDBC ä¸­é‡å¤æ“ä½œåšäº†å°è£…, åŒæ—¶æ‰©å±•å¹¶ä¼˜åŒ–éƒ¨åˆ†åŠŸèƒ½")])]),a._v(" "),s("h2",{attrs:{id:"_3ã€mybatis-å…³é”®è¯è¯´æ˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3ã€mybatis-å…³é”®è¯è¯´æ˜"}},[a._v("#")]),a._v(" 3ã€Mybatis å…³é”®è¯è¯´æ˜")]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ“– å¦‚æœåœ¨é˜…è¯»æ–‡ç« å‰æ²¡æœ‰æ¥è§¦è¿‡ Mybatis æºç ç›¸å…³çš„å†…å®¹, å»ºè®®å°†ä¸‹è¿°åè¯å¤šçœ‹å‡ éå†å‘ä¸‹é˜…è¯»")])]),a._v(" "),s("h3",{attrs:{id:"sqlsession"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sqlsession"}},[a._v("#")]),a._v(" SqlSession")]),a._v(" "),s("p",[a._v("è´Ÿè´£æ‰§è¡Œ "),s("strong",[a._v("selectã€insertã€updateã€delete")]),a._v(" ç­‰å‘½ä»¤, åŒæ—¶è´Ÿè´£è·å–æ˜ å°„å™¨å’Œç®¡ç†äº‹åŠ¡; å…¶åº•å±‚å°è£…äº†ä¸ JDBC çš„äº¤äº’, å¯ä»¥è¯´æ˜¯ mybatis æœ€æ ¸å¿ƒçš„æ¥å£ä¹‹ä¸€")]),a._v(" "),s("h3",{attrs:{id:"sqlsessionfactory"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sqlsessionfactory"}},[a._v("#")]),a._v(" SqlSessionFactory")]),a._v(" "),s("p",[a._v("è´Ÿè´£åˆ›å»º "),s("strong",[a._v("SqlSession")]),a._v(" çš„å·¥å‚, ä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨, "),s("strong",[a._v("ä¸éœ€è¦é¢å¤–å†è¿›è¡Œåˆ›å»º")])]),a._v(" "),s("h3",{attrs:{id:"sqlsessionfactorybuilder"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sqlsessionfactorybuilder"}},[a._v("#")]),a._v(" SqlSessionFactoryBuilder")]),a._v(" "),s("p",[a._v("ä¸»è¦æ˜¯è´Ÿè´£åˆ›å»º "),s("strong",[a._v("SqlSessionFactory")]),a._v(" çš„æ„é€ å™¨ç±», å…¶ä¸­ä½¿ç”¨åˆ°äº†æ„å»ºè€…è®¾è®¡æ¨¡å¼; ä»…è´Ÿè´£åˆ›å»º "),s("strong",[a._v("SqlSessionFactory")])]),a._v(" "),s("h3",{attrs:{id:"configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[a._v("#")]),a._v(" Configuration")]),a._v(" "),s("p",[a._v("Mybatis æœ€é‡è¦çš„é…ç½®ç±», æ²¡æœ‰ä¹‹ä¸€, å­˜å‚¨äº†å¤§é‡çš„å¯¹è±¡é…ç½®, å¯ä»¥çœ‹æºç æ„Ÿå—ä¸€ä¸‹")]),a._v(" "),s("h3",{attrs:{id:"mappedstatement"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mappedstatement"}},[a._v("#")]),a._v(" MappedStatement")]),a._v(" "),s("p",[a._v("MappedStatement æ˜¯ä¿å­˜ SQL è¯­å¥çš„æ•°æ®ç»“æ„, å…¶ä¸­çš„ç±»å±æ€§éƒ½æ˜¯ç”±è§£æ .xml æ–‡ä»¶ä¸­çš„ SQL æ ‡ç­¾è½¬åŒ–è€Œæˆ")]),a._v(" "),s("h3",{attrs:{id:"executor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#executor"}},[a._v("#")]),a._v(" Executor")]),a._v(" "),s("p",[a._v("SqlSession å¯¹è±¡å¯¹åº”ä¸€ä¸ª Executor, Executor å¯¹è±¡ä½œç”¨äº "),s("strong",[a._v("å¢åˆ æ”¹æŸ¥æ–¹æ³•")]),a._v(" ä»¥åŠ "),s("strong",[a._v("äº‹åŠ¡ã€ç¼“å­˜")]),a._v(" ç­‰æ“ä½œ")]),a._v(" "),s("h3",{attrs:{id:"parameterhandler"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#parameterhandler"}},[a._v("#")]),a._v(" ParameterHandler")]),a._v(" "),s("p",[a._v("Mybatis ä¸­çš„ "),s("strong",[a._v("å‚æ•°å¤„ç†å™¨")]),a._v(", ç±»å…³ç³»æ¯”è¾ƒç®€å•")]),a._v(" "),s("h3",{attrs:{id:"statementhandler"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#statementhandler"}},[a._v("#")]),a._v(" StatementHandler")]),a._v(" "),s("p",[a._v("StatementHandler æ˜¯ Mybatis è´Ÿè´£ "),s("strong",[a._v("åˆ›å»º Statement çš„å¤„ç†å™¨")]),a._v(", æ ¹æ®ä¸åŒçš„ä¸šåŠ¡åˆ›å»ºä¸åŒåŠŸèƒ½çš„ Statement")]),a._v(" "),s("h3",{attrs:{id:"resultsethandler"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#resultsethandler"}},[a._v("#")]),a._v(" ResultSetHandler")]),a._v(" "),s("p",[a._v("ResultSetHandler æ˜¯ Mybatis è´Ÿè´£å°† JDBC è¿”å›æ•°æ®è¿›è¡Œè§£æ, å¹¶åŒ…è£…ä¸º Java ä¸­å¯¹åº”æ•°æ®ç»“æ„çš„å¤„ç†å™¨")]),a._v(" "),s("h3",{attrs:{id:"interceptor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#interceptor"}},[a._v("#")]),a._v(" Interceptor")]),a._v(" "),s("p",[a._v("Interceptor ä¸º Mybatis ä¸­å®šä¹‰å…¬å…±æ‹¦æˆªå™¨çš„æ¥å£, å…¶ä¸­å®šä¹‰äº†ç›¸å…³å®ç°æ–¹æ³•")]),a._v(" "),s("h2",{attrs:{id:"_4ã€mybatis-æ¶æ„è®¾è®¡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4ã€mybatis-æ¶æ„è®¾è®¡"}},[a._v("#")]),a._v(" 4ã€Mybatis æ¶æ„è®¾è®¡")]),a._v(" "),s("h3",{attrs:{id:"_4-1-æ¶æ„å›¾"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-æ¶æ„å›¾"}},[a._v("#")]),a._v(" 4.1 æ¶æ„å›¾")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/Mybatis%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90-Mybatis%E6%9E%B6%E6%9E%84%E5%9B%BE_2.png",alt:"Mybatis åˆ†å±‚æ¶æ„å›¾"}})]),a._v(" "),s("h3",{attrs:{id:"_4-2-åŸºç¡€æ”¯æŒå±‚"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-åŸºç¡€æ”¯æŒå±‚"}},[a._v("#")]),a._v(" 4.2 åŸºç¡€æ”¯æŒå±‚")]),a._v(" "),s("h4",{attrs:{id:"åå°„æ¨¡å—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åå°„æ¨¡å—"}},[a._v("#")]),a._v(" åå°„æ¨¡å—")]),a._v(" "),s("p",[a._v("åå°„åœ¨ Java ä¸­çš„åº”ç”¨å¯ä»¥è¯´æ˜¯ç›¸å½“å¹¿æ³›äº†, åŒæ—¶ä¹Ÿæ˜¯ä¸€æŠŠåŒåˆƒå‰‘ã€‚ Mybatis æ¡†æ¶æœ¬èº« "),s("strong",[a._v("å°è£…å‡ºäº†åå°„æ¨¡å—")]),a._v(", æä¾›äº†æ¯”åŸç”Ÿåå°„æ›´ "),s("strong",[a._v("ç®€æ´æ˜“ç”¨çš„ API æ¥å£")]),a._v(", ä»¥åŠå¯¹ "),s("strong",[a._v("ç±»çš„å…ƒæ•°æ®å¢åŠ ç¼“å­˜, æé«˜åå°„çš„æ€§èƒ½")])]),a._v(" "),s("h4",{attrs:{id:"ç±»å‹è½¬æ¢"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç±»å‹è½¬æ¢"}},[a._v("#")]),a._v(" ç±»å‹è½¬æ¢")]),a._v(" "),s("p",[a._v("ç±»å‹è½¬æ¢æ¨¡å—æœ€é‡è¦çš„åŠŸèƒ½å°±æ˜¯åœ¨ä¸º SQL è¯­å¥ç»‘å®šå®å‚æ—¶, å°† "),s("strong",[a._v("Java ç±»å‹è½¬ä¸º JDBC ç±»å‹")]),a._v(", åœ¨æ˜ å°„ç»“æœé›†æ—¶å†ç”± "),s("strong",[a._v("JDBC ç±»å‹è½¬ä¸º Java ç±»å‹")])]),a._v(" "),s("p",[a._v("å¦å¤–ä¸€ä¸ªåŠŸèƒ½å°±æ˜¯æä¾›åˆ«åæœºåˆ¶, ç®€åŒ–äº†é…ç½®æ–‡ä»¶çš„å®šä¹‰")]),a._v(" "),s("h4",{attrs:{id:"æ—¥å¿—æ¨¡å—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ—¥å¿—æ¨¡å—"}},[a._v("#")]),a._v(" æ—¥å¿—æ¨¡å—")]),a._v(" "),s("p",[a._v("æ—¥å¿—å¯¹äºç³»ç»Ÿçš„ä½œç”¨ä¸è¨€è€Œå–», å°¤å…¶æ˜¯æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒä¸ŠæŸ¥çœ‹ä¿¡æ¯åŠæ’æŸ¥é”™è¯¯ç­‰éƒ½éå¸¸é‡è¦ã€‚ä¸»æµçš„æ—¥å¿—æ¡†æ¶åŒ…æ‹¬ Log4jã€Log4j2ã€S l f4j ç­‰, Mybatis çš„æ—¥å¿—æ¨¡å—ä½œç”¨å°±æ˜¯ "),s("strong",[a._v("é›†æˆè¿™äº›æ—¥å¿—æ¡†æ¶")])]),a._v(" "),s("h4",{attrs:{id:"èµ„æºåŠ è½½"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#èµ„æºåŠ è½½"}},[a._v("#")]),a._v(" èµ„æºåŠ è½½")]),a._v(" "),s("p",[a._v("Mybatis å¯¹ç±»åŠ è½½å™¨è¿›è¡Œäº†å°è£…, ç”¨æ¥ç¡®å®šç±»åŠ è½½å™¨çš„ä½¿ç”¨é¡ºåº, ç”¨æ¥è®°è½½ç±»æ–‡ä»¶ä»¥åŠå…¶å®ƒèµ„æºæ–‡ä»¶, æ„Ÿå…´è¶£å¯ä»¥å‚è€ƒ "),s("strong",[a._v("ClassLoaderWrapper")])]),a._v(" "),s("h4",{attrs:{id:"è§£æå™¨æ¨¡å—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è§£æå™¨æ¨¡å—"}},[a._v("#")]),a._v(" è§£æå™¨æ¨¡å—")]),a._v(" "),s("p",[a._v("è§£æå™¨æ¨¡å—ä¸»è¦æä¾›äº†ä¸¤ä¸ªåŠŸèƒ½, ä¸€ä¸ªæ˜¯å°è£…äº† XPath ç±», åœ¨ Mybatis åˆå§‹åŒ–æ—¶è§£æ Mybatis-config.xml é…ç½®æ–‡ä»¶ä»¥åŠæ˜ å°„é…ç½®æ–‡ä»¶æä¾›åŠŸèƒ½, å¦ä¸€ç‚¹å°±æ˜¯å¤„ç†åŠ¨æ€ SQL è¯­å¥çš„å ä½ç¬¦æä¾›å¸®åŠ©")]),a._v(" "),s("h4",{attrs:{id:""}},[s("a",{staticClass:"header-anchor",attrs:{href:"#"}},[a._v("#")]),a._v(" ...")]),a._v(" "),s("h3",{attrs:{id:"_4-3-æ ¸å¿ƒå¤„ç†å±‚"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-æ ¸å¿ƒå¤„ç†å±‚"}},[a._v("#")]),a._v(" 4.3 æ ¸å¿ƒå¤„ç†å±‚")]),a._v(" "),s("h4",{attrs:{id:"é…ç½®è§£æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®è§£æ"}},[a._v("#")]),a._v(" é…ç½®è§£æ")]),a._v(" "),s("p",[a._v("åœ¨ Mybatis åˆå§‹åŒ–æ—¶, ä¼šåŠ è½½ Mybatis-config.xml æ–‡ä»¶ä¸­çš„é…ç½®ä¿¡æ¯, è§£æåçš„é…ç½®ä¿¡æ¯ä¼š "),s("strong",[a._v("è½¬æ¢æˆ Java å¯¹è±¡æ·»åŠ åˆ° Configuration å¯¹è±¡")])]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ“– æ¯”å¦‚è¯´åœ¨ .xml ä¸­å®šä¹‰çš„ resultMap æ ‡ç­¾, ä¼šè¢«è§£æä¸º ResultMap å¯¹è±¡")])]),a._v(" "),s("h4",{attrs:{id:"sql-è§£æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sql-è§£æ"}},[a._v("#")]),a._v(" SQL è§£æ")]),a._v(" "),s("p",[a._v("å¤§å®¶å¦‚æœæ‰‹åŠ¨æ‹¼å†™è¿‡å¤æ‚ SQL è¯­å¥, å°±ä¼šæ˜ç™½ä¼šæœ‰å¤šç—›è‹¦ã€‚Mybatis æä¾›å‡ºäº†åŠ¨æ€ SQL, åŠ å…¥äº†è®¸å¤šåˆ¤æ–­å¾ªç¯å‹æ ‡ç­¾, æ¯”å¦‚ : ifã€whereã€foreachã€set ç­‰, å¸®åŠ©å¼€å‘è€…èŠ‚çº¦äº†å¤§é‡çš„ SQL æ‹¼å†™æ—¶é—´")]),a._v(" "),s("p",[a._v("SQL è§£ææ¨¡å—çš„ä½œç”¨å°±æ˜¯å°† Mybatis æä¾›çš„åŠ¨æ€ SQL æ ‡ç­¾è§£æä¸ºå¸¦å ä½ç¬¦çš„ SQL è¯­å¥, å¹¶åœ¨åæœŸå°†å®å‚å¯¹å ä½ç¬¦è¿›è¡Œæ›¿æ¢")]),a._v(" "),s("h4",{attrs:{id:"sql-æ‰§è¡Œ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sql-æ‰§è¡Œ"}},[a._v("#")]),a._v(" SQL æ‰§è¡Œ")]),a._v(" "),s("p",[a._v("SQL çš„æ‰§è¡Œè¿‡ç¨‹æ¶‰åŠå‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å¯¹è±¡, "),s("strong",[a._v("Executorã€StatementHandlerã€ParameterHandlerã€ResultSetHandler")])]),a._v(" "),s("p",[a._v("Executor è´Ÿè´£ç»´æŠ¤ "),s("strong",[a._v("ä¸€çº§ã€äºŒçº§ç¼“å­˜ä»¥åŠäº‹åŠ¡æäº¤å›æ»šæ“ä½œ")]),a._v(", ä¸¾ä¸ªæŸ¥è¯¢çš„ä¾‹å­, æŸ¥è¯¢è¯·æ±‚ä¼šç”± Executor äº¤ç»™ StatementHandler å®Œæˆ")]),a._v(" "),s("p",[a._v("StatementHandler é€šè¿‡ ParameterHandler å®Œæˆ "),s("strong",[a._v("SQL è¯­å¥çš„å®å‚ç»‘å®š")]),a._v(", é€šè¿‡ java.sql.Statement æ‰§è¡Œ SQL è¯­å¥å¹¶æ‹¿åˆ°å¯¹åº”çš„ "),s("strong",[a._v("ç»“æœé›†æ˜ å°„")])]),a._v(" "),s("p",[a._v("æœ€åäº¤ç”± ResultSetHandler å¯¹ç»“æœé›†è¿›è¡Œè§£æ, å°† JDBC ç±»å‹è½¬æ¢ä¸ºç¨‹åºè‡ªå®šä¹‰çš„å¯¹è±¡")]),a._v(" "),s("h4",{attrs:{id:"æ’ä»¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ’ä»¶"}},[a._v("#")]),a._v(" æ’ä»¶")]),a._v(" "),s("p",[a._v("æ’ä»¶æ¨¡å—æ˜¯ Mybatis æä¾›çš„ä¸€å±‚æ‰©å±•, å¯ä»¥é’ˆå¯¹ SQL æ‰§è¡Œçš„å››å¤§å¯¹è±¡è¿›è¡Œ "),s("strong",[a._v("æ‹¦æˆªå¹¶æ‰§è¡Œè‡ªå®šä¹‰æ’ä»¶")])]),a._v(" "),s("p",[a._v("æ’ä»¶ç¼–å†™éœ€è¦å¾ˆç†Ÿæ‚‰ Mybatis è¿è¡Œæœºåˆ¶, è¿™æ ·æ‰èƒ½æ§åˆ¶ç¼–å†™çš„æ’ä»¶å®‰å…¨ã€é«˜æ•ˆ")]),a._v(" "),s("h3",{attrs:{id:"_4-4-æ¥å£å±‚"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-æ¥å£å±‚"}},[a._v("#")]),a._v(" 4.4 æ¥å£å±‚")]),a._v(" "),s("p",[a._v("æ¥å£å±‚åªæ˜¯ Mybatis "),s("strong",[a._v("æä¾›ç»™è°ƒç”¨ç«¯çš„ä¸€ä¸ªæ¥å£ SqlSession")]),a._v(", è°ƒç”¨ç«¯åœ¨è¿›è¡Œè°ƒç”¨æ¥å£ä¸­æ–¹æ³•æ—¶, ä¼šè°ƒç”¨æ ¸å¿ƒå¤„ç†å±‚ç›¸å¯¹åº”çš„æ¨¡å—æ¥å®Œæˆæ•°æ®åº“æ“ä½œ")]),a._v(" "),s("h2",{attrs:{id:"_5ã€é—®é¢˜ç­”ç–‘"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5ã€é—®é¢˜ç­”ç–‘"}},[a._v("#")]),a._v(" 5ã€é—®é¢˜ç­”ç–‘")]),a._v(" "),s("h3",{attrs:{id:"_5-1-xml-æ–‡ä»¶å®šä¹‰-sql-è¯­å¥å¦‚ä½•è§£æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-xml-æ–‡ä»¶å®šä¹‰-sql-è¯­å¥å¦‚ä½•è§£æ"}},[a._v("#")]),a._v(" 5.1 .xml æ–‡ä»¶å®šä¹‰ Sql è¯­å¥å¦‚ä½•è§£æ")]),a._v(" "),s("p",[a._v("Mybatis åœ¨åˆ›å»º SqlSessionFactory æ—¶, XMLConfigBuilder ä¼šè§£æ Mybatis-config.xml é…ç½®æ–‡ä»¶")]),a._v(" "),s("h4",{attrs:{id:"mybatis-ç›¸å…³è§£æå™¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mybatis-ç›¸å…³è§£æå™¨"}},[a._v("#")]),a._v(" Mybatis ç›¸å…³è§£æå™¨")]),a._v(" "),s("p",[a._v("Mybatis è§£æå™¨æ¨¡å—ä¸­å®šä¹‰äº†ç›¸å…³è§£æå™¨çš„æŠ½è±¡ç±» BaseBuilder, ä¸åŒçš„å­ç±»è´Ÿè´£å®ç°è§£æä¸åŒçš„åŠŸèƒ½, ä½¿ç”¨äº† Builder è®¾è®¡æ¨¡å¼")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/image-20200902131259623.png",alt:"BaseBuilder"}})]),a._v(" "),s("p",[a._v("XMLConfigBuilder è´Ÿè´£è§£æ mybatis-config.xml é…ç½®æ–‡ä»¶")]),a._v(" "),s("p",[a._v("XMLMapperBuilder è´Ÿè´£è§£æä¸šåŠ¡äº§ç”Ÿçš„ xxxMapper.xml")]),a._v(" "),s("p",[a._v("...")]),a._v(" "),s("h4",{attrs:{id:"mybatis-config-xml-è§£æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mybatis-config-xml-è§£æ"}},[a._v("#")]),a._v(" mybatis-config.xml è§£æ")]),a._v(" "),s("p",[a._v("XMLConfigBuilder è§£æ mybatis-config.xml å†…å®¹å‚è€ƒä»£ç  :")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/parseConfiguration.png",alt:"parseConfiguration"}})]),a._v(" "),s("p",[s("strong",[a._v("XMLConfifigBuilder#parseConfiguration()")]),a._v(" æ–¹æ³•å°† mybatis-config.xml ä¸­å®šä¹‰çš„æ ‡ç­¾è¿›è¡Œç›¸å…³è§£æå¹¶å¡«å……åˆ° Configuration å¯¹è±¡ä¸­")]),a._v(" "),s("h4",{attrs:{id:"xxxmapper-xml-è§£æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xxxmapper-xml-è§£æ"}},[a._v("#")]),a._v(" xxxMapper.xml è§£æ")]),a._v(" "),s("p",[s("strong",[a._v("XMLConfifigBuilder#mapperElement()")]),a._v(" ä¸­è§£æé…ç½®çš„ mappers æ ‡ç­¾, æ‰¾åˆ°å…·ä½“çš„ .xml æ–‡ä»¶, å¹¶å°†å…¶ä¸­çš„ selectã€insertã€updateã€deleteã€resultMap ç­‰æ ‡ç­¾è§£æä¸º Java ä¸­çš„å¯¹è±¡ä¿¡æ¯")]),a._v(" "),s("p",[a._v("å…·ä½“è§£æ xxxMapper.xml çš„å¯¹è±¡ä¸º XMLMapperBuilder, å…·ä½“çš„è§£ææ–¹æ³•ä¸º parse()")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/parse.png",alt:"parse"}})]),a._v(" "),s("p",[a._v("åˆ°è¿™é‡Œå°±å¯ä»¥å¯¹å½“å‰é—®é¢˜ä½œå‡ºç­”å¤äº†")]),a._v(" "),s("p",[a._v("Mybatis åˆ›å»º "),s("strong",[a._v("SqlSessionFactory")]),a._v(" ä¼šè§£æ "),s("strong",[a._v("mybatis-config.xml")]),a._v(", ç„¶å "),s("strong",[a._v("è§£æ configuration æ ‡ç­¾ä¸‹çš„å­æ ‡ç­¾")]),a._v(", è§£æ mappers æ ‡ç­¾æ—¶, ä¼šæ ¹æ®ç›¸å…³é…ç½®è¯»å–åˆ° .xml æ–‡ä»¶, ç»§è€Œè§£æ .xml ä¸­å„ä¸ªæ ‡ç­¾")]),a._v(" "),s("p",[a._v("å…·ä½“çš„ selectã€insertã€updateã€delete æ ‡ç­¾å®šä¹‰ä¸º "),s("strong",[a._v("MappedStatement")]),a._v(" å¯¹è±¡, .xml æ–‡ä»¶ä¸­çš„å…¶ä½™æ ‡ç­¾ä¹Ÿä¼šæ ¹æ®ä¸åŒæ˜ å°„è§£æä¸º Java å¯¹è±¡")]),a._v(" "),s("h4",{attrs:{id:"mappedstatement-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mappedstatement-2"}},[a._v("#")]),a._v(" MappedStatement")]),a._v(" "),s("p",[a._v("è¿™é‡Œé‡ç‚¹è¯´æ˜ä¸‹ MappedStatement å¯¹è±¡, ä¸€èµ·çœ‹ä¸€ä¸‹ç±»ä¸­çš„å±æ€§å’Œ SQL æœ‰ä½•å…³è”å‘¢")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/MappedStatement.png",alt:"MappedStatement"}})]),a._v(" "),s("p",[a._v("MappedStatement å¯¹è±¡ä¸­ "),s("strong",[a._v("æä¾›çš„å±æ€§ä¸ .xml æ–‡ä»¶ä¸­å®šä¹‰çš„ SQL è¯­å¥")]),a._v(" æ˜¯èƒ½å¤Ÿå¯¹åº”ä¸Šçš„, ç”¨æ¥ "),s("strong",[a._v("æ§åˆ¶æ¯æ¡ SQL è¯­å¥çš„æ‰§è¡Œè¡Œä¸º")])]),a._v(" "),s("h3",{attrs:{id:"_5-2-mapper-æ¥å£çš„å­˜å‚¨ä¸å®ç°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-mapper-æ¥å£çš„å­˜å‚¨ä¸å®ç°"}},[a._v("#")]),a._v(" 5.2 Mapper æ¥å£çš„å­˜å‚¨ä¸å®ç°")]),a._v(" "),s("p",[a._v("åœ¨å¹³å¸¸æˆ‘ä»¬å†™çš„ SSM æ¡†æ¶ä¸­, å®šä¹‰äº† Mapper æ¥å£ä¸ .xml å¯¹åº”çš„ SQL æ–‡ä»¶, åœ¨ Service å±‚ç›´æ¥æ³¨å…¥ xxxMapper å°±å¯ä»¥äº†")]),a._v(" "),s("p",[a._v("ä¹Ÿæ²¡æœ‰çœ‹åˆ°åƒ JDBC æ“ä½œæ•°æ®åº“çš„æ“ä½œ, Mybatis åœ¨ä¸­é—´æ˜¯å¦‚ä½•ä¸ºæˆ‘ä»¬çœç•¥ä¸‹è¿™äº›é‡å¤ç¹ççš„æ“ä½œå‘¢")]),a._v(" "),s("p",[a._v("è¿™é‡Œä½¿ç”¨ Mybatis æºç ä¸­çš„æµ‹è¯•ç±»è¿›è¡ŒéªŒè¯, é¦–å…ˆå®šä¹‰ Mapper æ¥å£, çœäº‹ç›´æ¥æ³¨è§£å®šä¹‰ SQL")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/AutoConstructorMapper_new.png",alt:"AutoConstructorMapper"}})]),a._v(" "),s("p",[a._v("è¿™é‡Œä½¿ç”¨ SqlSession æ¥è·å– Mapper æ“ä½œæ•°æ®åº“, æµ‹è¯•æ–¹æ³•å¦‚ä¸‹")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/primitiveSubjects.png",alt:"primitiveSubjects"}})]),a._v(" "),s("h4",{attrs:{id:"åˆ›å»º-sqlsession"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-sqlsession"}},[a._v("#")]),a._v(" åˆ›å»º SqlSession")]),a._v(" "),s("p",[a._v("#1 ä» SqlSessionFactory ä¸­æ‰“å¼€ä¸€ä¸ª æ–°çš„ SqlSession")]),a._v(" "),s("h4",{attrs:{id:"è·å–-mapper-å®ä¾‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è·å–-mapper-å®ä¾‹"}},[a._v("#")]),a._v(" è·å– Mapper å®ä¾‹")]),a._v(" "),s("p",[a._v("#2 å°±å­˜åœ¨ä¸€ä¸ªç–‘é—®ç‚¹, å®šä¹‰çš„ AutoConstructorMapper æ˜æ˜æ˜¯ä¸ªæ¥å£, "),s("strong",[a._v("ä¸ºä»€ä¹ˆå¯ä»¥å®ä¾‹åŒ–ä¸ºå¯¹è±¡?")])]),a._v(" "),s("h4",{attrs:{id:"åŠ¨æ€ä»£ç†æ–¹æ³•è°ƒç”¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŠ¨æ€ä»£ç†æ–¹æ³•è°ƒç”¨"}},[a._v("#")]),a._v(" åŠ¨æ€ä»£ç†æ–¹æ³•è°ƒç”¨")]),a._v(" "),s("p",[a._v("#3 é€šè¿‡åˆ›å»ºçš„å¯¹è±¡è°ƒç”¨ç±»ä¸­å…·ä½“çš„æ–¹æ³•, è¿™é‡Œå…·ä½“èŠä¸€ä¸‹ #2 æ“ä½œ")]),a._v(" "),s("p",[a._v("SqlSession æ˜¯ä¸€ä¸ªæ¥å£, æœ‰ä¸€ä¸ª "),s("strong",[a._v("é»˜è®¤çš„å®ç°ç±» DefaultSqlSession")]),a._v(", ç±»ä¸­åŒ…å«äº† Configuration å±æ€§")]),a._v(" "),s("p",[a._v("Mapper æ¥å£çš„ä¿¡æ¯ä»¥åŠ .xml ä¸­ SQL è¯­å¥æ˜¯åœ¨ Mybatis "),s("strong",[a._v("åˆå§‹åŒ–æ—¶æ·»åŠ ")]),a._v(" åˆ° Configuration çš„ "),s("strong",[a._v("MapperRegistry")]),a._v(" å±æ€§ä¸­çš„")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/addMapper.png",alt:"MapperRegistry#addMapper"}})]),a._v(" "),s("p",[a._v("#2 ä¸­çš„ getMapper å°±æ˜¯ä» MapperRegistry ä¸­è·å– Mapper")]),a._v(" "),s("p",[a._v("çœ‹ä¸€ä¸‹ MapperRegistry çš„ç±»å±æ€§éƒ½æœ‰ä»€ä¹ˆ")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/MapperRegistry.png",alt:"MapperRegistry"}})]),a._v(" "),s("p",[a._v("config ä¸º "),s("strong",[a._v("ä¿æŒå…¨å±€å”¯ä¸€")]),a._v(" çš„ Configuration å¯¹è±¡å¼•ç”¨")]),a._v(" "),s("p",[s("strong",[a._v("knownMappers")]),a._v(" ä¸­ Key-Class æ˜¯ Mapper å¯¹è±¡, Value-MapperProxyFactory æ˜¯é€šè¿‡ Mapper å¯¹è±¡è¡ç”Ÿå‡ºçš„ "),s("strong",[a._v("Mapper ä»£ç†å·¥å‚")])]),a._v(" "),s("p",[a._v("å†çœ‹ä¸€ä¸‹ MapperProxyFactory ç±»çš„ç»“æ„ä¿¡æ¯")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/MapperProxyFactory.png",alt:"MapperProxyFactory"}})]),a._v(" "),s("p",[a._v("mapperInterface å±æ€§æ˜¯ Mapper å¯¹è±¡çš„å¼•ç”¨, methodCache çš„ key æ˜¯ Mapper ä¸­çš„æ–¹æ³•, value æ˜¯ Mapper è§£æå¯¹åº” SQL äº§ç”Ÿçš„ MapperMethod")]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ“– Mybatis è®¾è®¡ methodCache å±æ€§æ—¶ä½¿ç”¨åˆ°äº† "),s("strong",[a._v("æ‡’åŠ è½½æœºåˆ¶")]),a._v(", åœ¨åˆå§‹åŒ–æ—¶ä¸ä¼šå¢åŠ å¯¹åº” Method, è€Œæ˜¯åœ¨ "),s("strong",[a._v("ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ–°å¢")])])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/cachedMapperMethod.png",alt:"cachedMapperMethod"}})]),a._v(" "),s("p",[a._v("MapperMethod è¿è¡Œæ—¶æ•°æ®å¦‚ä¸‹, æ¯”è¾ƒå®¹æ˜“ç†è§£")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/image-20200902133450941.png",alt:"MapperMethod è¿è¡ŒçŠ¶æ€"}})]),a._v(" "),s("p",[a._v("é€šè¿‡ä¸€ä¸ªå®é™…ä¾‹å­å¸®å¿™ç†è§£ä¸€ä¸‹ MapperRegistry ç±»å…³ç³», Mapper åˆå§‹åŒ–ç¬¬ä¸€æ¬¡è°ƒç”¨çš„å¯¹è±¡çŠ¶æ€, å¯ä»¥çœ‹åˆ° methodCache å®¹é‡ä¸º0")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/image-20200821191913092.png",alt:"MapperRegistry è¿è¡ŒçŠ¶æ€"}})]),a._v(" "),s("p",[a._v("æˆ‘ä»¬ç›®å‰å·²ç»çŸ¥é“ MapperRegistry çš„ç±»å…³ç³», å›å¤´ç»§ç»­çœ‹ä¸€ä¸‹ç¬¬äºŒæ­¥çš„ "),s("strong",[a._v("MapperRegistry#getMapper")]),a._v("() å¤„ç†æ­¥éª¤")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/getMapper.png",alt:"getMapper"}})]),a._v(" "),s("p",[a._v("æ ¸å¿ƒå¤„ç†åœ¨ MapperProxyFactory#newInstance() æ–¹æ³•ä¸­, ç»§ç»­è·Ÿè¿›")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/newInstance.png",alt:"newInstance"}})]),a._v(" "),s("p",[a._v("MapperProxy "),s("strong",[a._v("ç»§æ‰¿äº† InvocationHandler æ¥å£")]),a._v(", é€šè¿‡ newInstance() æœ€ç»ˆè¿”å›çš„æ˜¯ç”± "),s("strong",[a._v("Java Proxy åŠ¨æ€ä»£ç†è¿”å›çš„åŠ¨æ€ä»£ç†å®ç°ç±»")])]),a._v(" "),s("p",[a._v("çœ‹åˆ°è¿™é‡Œå°±æ¸…æ¥šäº†æ­¥éª¤äºŒä¸­æ¥å£ä¸ºä»€ä¹ˆèƒ½å¤Ÿè¢«å®ä¾‹åŒ–, è¿”å›çš„æ˜¯ "),s("strong",[a._v("æ¥å£çš„åŠ¨æ€ä»£ç†å®ç°ç±»")])]),a._v(" "),s("h3",{attrs:{id:"_5-3-mybatis-sql-çš„æ‰§è¡Œè¿‡ç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-mybatis-sql-çš„æ‰§è¡Œè¿‡ç¨‹"}},[a._v("#")]),a._v(" 5.3 Mybatis Sql çš„æ‰§è¡Œè¿‡ç¨‹")]),a._v(" "),s("p",[a._v("æ ¹æ® Mybatis SQL æ‰§è¡Œæµç¨‹å›¾è¿›ä¸€æ­¥äº†è§£")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/Mybatis-SQL%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B.png",alt:"Mybatis-SQLæ‰§è¡Œæµç¨‹"}})]),a._v(" "),s("p",[a._v("å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥æ“ä½œ:")]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ“– åœ¨å‰é¢çš„å†…å®¹ä¸­, çŸ¥é“äº† Mybatis Mapper æ˜¯åŠ¨æ€ä»£ç†çš„å®ç°, æŸ¥çœ‹ SQL æ‰§è¡Œè¿‡ç¨‹, å°±éœ€è¦ç´§è·Ÿå®ç°äº† InvocationHandler çš„ MapperProxy ç±»")])]),a._v(" "),s("h4",{attrs:{id:"æ‰§è¡Œå¢åˆ æ”¹æŸ¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ‰§è¡Œå¢åˆ æ”¹æŸ¥"}},[a._v("#")]),a._v(" æ‰§è¡Œå¢åˆ æ”¹æŸ¥")]),a._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Select")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('" SELECT * FROM SUBJECT WHERE ID = #{id}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("PrimitiveSubject")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getSubject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Param")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"id"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("æˆ‘ä»¬ä»¥ä¸Šè¿°æ–¹æ³•ä¸¾ä¾‹, è°ƒç”¨æ–¹é€šè¿‡ SqlSession è·å– Mapper åŠ¨æ€ä»£ç†å¯¹è±¡, æ‰§è¡Œ Mapper æ–¹æ³•æ—¶ä¼šé€šè¿‡ "),s("strong",[a._v("InvocationHandler è¿›è¡Œä»£ç†")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/MapperProxy.png",alt:"MapperProxy"}})]),a._v(" "),s("p",[a._v("åœ¨ MapperMethod#execute ä¸­, æ ¹æ® MapperMethod -> SqlCommand -> "),s("strong",[a._v("SqlCommandType")]),a._v(" æ¥ç¡®å®šå¢ã€åˆ ã€æ”¹ã€æŸ¥æ–¹æ³•")]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ“– SqlCommandType æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹, å¯¹åº”äº”ç§ç±»å‹ UNKNOWNã€INSERTã€UPDATEã€DELETEã€SELECTã€FLUSH")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/execute.png",alt:"execute"}})]),a._v(" "),s("h4",{attrs:{id:"å‚æ•°å¤„ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‚æ•°å¤„ç†"}},[a._v("#")]),a._v(" å‚æ•°å¤„ç†")]),a._v(" "),s("p",[a._v("æŸ¥è¯¢æ“ä½œå¯¹åº” SELECT æšä¸¾å€¼, if else ä¸­åˆ¤æ–­ä¸ºè¿”å›å€¼æ˜¯å¦é›†åˆã€æ— è¿”å›å€¼ã€å•æ¡æŸ¥è¯¢ç­‰, è¿™é‡Œä»¥æŸ¥è¯¢å•æ¡è®°å½•ä½œä¸ºå…¥å£")]),a._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Object")]),a._v(" param "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("convertArgsToSqlCommandParam")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nresult "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sqlSession"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("selectOne")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/convertArgsToSqlCommandParam_new.png",alt:"convertArgsToSqlCommandParam_new"}})]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/image-20200902124629730.png",alt:"å‚æ•°è§£æ"}})]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ“– è¿™é‡Œèƒ½å¤Ÿè§£é‡Šä¸€ä¸ªä¹‹å‰å›°æ‰°æˆ‘çš„é—®é¢˜, é‚£å°±æ˜¯ä¸ºä»€ä¹ˆæ–¹æ³•å…¥å‚åªæœ‰å•ä¸ª "),s("code",[a._v('@Param("id")')]),a._v(", ä½†æ˜¯å‚æ•° param å¯¹è±¡ä¼šå­˜åœ¨ä¸¤ä¸ªé”®å€¼å¯¹")])]),a._v(" "),s("p",[a._v("ç»§ç»­æŸ¥çœ‹ "),s("strong",[a._v("SqlSession#selectOne")]),a._v(" æ–¹æ³•, sqlSession æ˜¯ä¸€ä¸ªæ¥å£, å…·ä½“è¿˜æ˜¯è¦çœ‹å®ç°ç±» "),s("strong",[a._v("DefaultSqlSession")])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/selectOne.png",alt:"selectOne"}})]),a._v(" "),s("p",[a._v("å› ä¸ºå•æ¡å’ŒæŸ¥è¯¢å¤šæ¡ä»¥åŠåˆ†é¡µæŸ¥è¯¢éƒ½æ˜¯èµ°çš„ä¸€ä¸ªæ–¹æ³•, æ‰€ä»¥åœ¨æŸ¥è¯¢çš„è¿‡ç¨‹ä¸­, ä¼šå°†åˆ†é¡µçš„å‚æ•°è¿›è¡Œæ·»åŠ ")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/selectList_new.png",alt:"selectList"}})]),a._v(" "),s("h4",{attrs:{id:"æ‰§è¡Œå™¨å¤„ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ‰§è¡Œå™¨å¤„ç†"}},[a._v("#")]),a._v(" æ‰§è¡Œå™¨å¤„ç†")]),a._v(" "),s("p",[a._v("åœ¨ Mybatis æºç ä¸­, åˆ›å»ºçš„æ‰§è¡Œå™¨é»˜è®¤æ˜¯ "),s("strong",[a._v("CachingExecutor,")]),a._v(" ä½¿ç”¨äº†è£…é¥°è€…æ¨¡å¼, åœ¨ç±»ä¸­ä¿æŒäº† "),s("strong",[a._v("Executor")]),a._v(" æ¥å£çš„å¼•ç”¨, "),s("strong",[a._v("CachingExecutor")]),a._v(" åœ¨æŒæœ‰çš„æ‰§è¡Œå™¨åŸºç¡€ä¸Šå¢åŠ äº†ç¼“å­˜çš„åŠŸèƒ½")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/CachingExecutor-query-new.png",alt:"CachingExecutor#query"}})]),a._v(" "),s("p",[s("strong",[a._v("delegate."),s("E",[a._v("query")])],1),a._v(" å°±æ˜¯åœ¨å…·ä½“çš„æ‰§è¡Œå™¨äº†, é»˜è®¤ "),s("strong",[a._v("SimpleExecutor,")]),a._v(" query æ–¹æ³•ç»Ÿä¸€åœ¨æŠ½è±¡çˆ¶ç±» "),s("strong",[a._v("BaseExecutor")]),a._v(" ä¸­ç»´æŠ¤")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/BaseExecutor_query.png",alt:"BaseExecutor#query"}})]),a._v(" "),s("p",[s("strong",[a._v("BaseExecutor#queryFromDatabase")]),a._v(" æ–¹æ³•æ‰§è¡Œäº†ç¼“å­˜å ä½ç¬¦ä»¥åŠæ‰§è¡Œå…·ä½“æ–¹æ³•, å¹¶å°†æŸ¥è¯¢è¿”å›æ•°æ®æ·»åŠ è‡³ç¼“å­˜")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/queryFromDatabase.png",alt:"queryFromDatabase"}})]),a._v(" "),s("p",[s("strong",[a._v("BaseExecutor#doQuery")]),a._v(" æ–¹æ³•æ˜¯ç”±å…·ä½“çš„ SimpleExecutor å®ç°")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/doQuery.png",alt:"doQuery"}})]),a._v(" "),s("h4",{attrs:{id:"æ‰§è¡Œ-sql"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ‰§è¡Œ-sql"}},[a._v("#")]),a._v(" æ‰§è¡Œ SQL")]),a._v(" "),s("p",[a._v("å› ä¸ºæˆ‘ä»¬ SQL ä¸­ä½¿ç”¨äº†å‚æ•°å ä½ç¬¦, ä½¿ç”¨çš„æ˜¯ "),s("strong",[a._v("PreparedStatementHandler")]),a._v(" å¯¹è±¡, æ‰§è¡Œé¢„ç¼–è¯‘SQLçš„ Handler, å®é™…ä½¿ç”¨ "),s("strong",[a._v("PreparedStatement")]),a._v(" è¿›è¡Œ SQL è°ƒç”¨")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/PreparedStatementHandler_query.png",alt:"PreparedStatementHandler_query"}})]),a._v(" "),s("h4",{attrs:{id:"è¿”å›æ•°æ®è§£æ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è¿”å›æ•°æ®è§£æ"}},[a._v("#")]),a._v(" è¿”å›æ•°æ®è§£æ")]),a._v(" "),s("p",[a._v("å°† JDBC è¿”å›ç±»å‹è½¬æ¢ä¸º Java ç±»å‹, æ ¹æ® resultSets å’Œ resultMap è¿›è¡Œè½¬æ¢")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/handleResultSets.png",alt:"handleResultSets"}})]),a._v(" "),s("h3",{attrs:{id:"_5-4-mybatis-ä¸­åˆ†é¡µå¦‚ä½•å®ç°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-mybatis-ä¸­åˆ†é¡µå¦‚ä½•å®ç°"}},[a._v("#")]),a._v(" 5.4 Mybatis ä¸­åˆ†é¡µå¦‚ä½•å®ç°")]),a._v(" "),s("p",[a._v("é€šè¿‡ Mybatis æ‰§è¡Œåˆ†é¡µ SQL æœ‰ä¸¤ç§å®ç°æ–¹å¼, ä¸€ç§æ˜¯ç¼–å†™ SQL æ—¶æ·»åŠ  LIMIT, ä¸€ç§æ˜¯å…¨å±€å¤„ç†")]),a._v(" "),s("h4",{attrs:{id:"sql-åˆ†é¡µ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sql-åˆ†é¡µ"}},[a._v("#")]),a._v(" SQL åˆ†é¡µ")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" id"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"getSubjectByPage"')]),a._v(" resultMap"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"resultAutoMap"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" SUBJECT "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("LIMIT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#{CURRINDEX} , #{PAGESIZE}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h4",{attrs:{id:"æ‹¦æˆªå™¨åˆ†é¡µ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ‹¦æˆªå™¨åˆ†é¡µ"}},[a._v("#")]),a._v(" æ‹¦æˆªå™¨åˆ†é¡µ")]),a._v(" "),s("p",[a._v("ä¸Šæ–‡è¯´åˆ°, Mybatis æ”¯æŒäº†æ’ä»¶æ‰©å±•æœºåˆ¶, å¯ä»¥æ‹¦æˆªåˆ°å…·ä½“å¯¹è±¡çš„æ–¹æ³•ä»¥åŠå¯¹åº”å…¥å‚çº§åˆ«")]),a._v(" "),s("p",[a._v("æˆ‘ä»¬æ·»åŠ æ’ä»¶æ—¶éœ€è¦å®ç° "),s("strong",[a._v("Interceptor")]),a._v(" æ¥å£, ç„¶åå°†æ’ä»¶å†™åœ¨ mybatis-config.xml é…ç½®æ–‡ä»¶ä¸­æˆ–è€…æ·»åŠ ç›¸å…³æ³¨è§£, Mybatis åˆå§‹åŒ–æ—¶è§£ææ‰èƒ½åœ¨é¡¹ç›®å¯åŠ¨æ—¶æ·»åŠ åˆ°æ’ä»¶å®¹å™¨ä¸­")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/pluginElement.png",alt:"pluginElement"}})]),a._v(" "),s("p",[a._v("ç”±ä¸€ä¸ª List ç»“æ„å­˜å‚¨é¡¹ç›®ä¸­å…¨éƒ¨æ‹¦æˆªå™¨, é€šè¿‡ "),s("strong",[a._v("Configuration#addInterceptor")]),a._v(" æ–¹æ³•æ·»åŠ ")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/InterceptorChain.png",alt:"InterceptorChain"}})]),a._v(" "),s("p",[a._v("é‡ç‚¹éœ€è¦å…³æ³¨ "),s("strong",[a._v("Interceptor#pluginAll")]),a._v(" ä¸­ plugin æ–¹æ³•, Interceptor åªæ˜¯ä¸€ä¸ªæ¥å£, plugin æ–¹æ³•åªèƒ½ç”±å…¶å®ç°ç±»å®Œæˆ")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/ExamplePlugin.png",alt:"ExamplePlugin"}})]),a._v(" "),s("p",[a._v("Plugin å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªå·¥å…·ç±», "),s("strong",[a._v("Plugin#wrap")]),a._v(" è¿”å›çš„æ˜¯ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±» ")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/wrap.png",alt:"wrap"}})]),a._v(" "),s("p",[a._v("è¿™é‡Œä½¿ç”¨ä¸€ä¸ªæµ‹è¯•çš„ Demo çœ‹ä¸€ä¸‹æ–¹æ³•è¿è¡Œæ—¶çš„å‚æ•°")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/AlwaysMapPlugin.png",alt:"AlwaysMapPlugin"}})]),a._v(" "),s("p",[a._v("è™½ç„¶æ˜¯éšä¾¿å†™çš„ Demo, ä½†æ˜¯ä¸æ­£å¼ä½¿ç”¨çš„æ’ä»¶å¹¶æ— å®é™…åŒºåˆ«")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://images-machen.oss-cn-beijing.aliyuncs.com/image-20200902103355292.png",alt:"æ’ä»¶è¿è¡ŒçŠ¶æ€"}})]),a._v(" "),s("h2",{attrs:{id:"_6ã€ç›¸å…³é“¾æ¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6ã€ç›¸å…³é“¾æ¥"}},[a._v("#")]),a._v(" 6ã€ç›¸å…³é“¾æ¥")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/Mybatis/Mybatis-3",title:"æºç ä¸‹è½½åœ°å€",target:"_blank",rel:"noopener noreferrer"}},[a._v("æºç ä¸‹è½½åœ°å€"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://carbon.now.sh/",target:"_blank",rel:"noopener noreferrer"}},[a._v("ä»£ç ç”Ÿæˆå›¾ç‰‡"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.mdnice.com/",target:"_blank",rel:"noopener noreferrer"}},[a._v("å¤šåŠŸèƒ½åœ¨çº¿Markdownç¼–è¾‘å™¨"),s("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=r.exports}}]);